# VLM Comparison Tools

This repository contains two Streamlit applications for comparing outputs from vision-language models (VLMs). These tools are designed to conduct blind, side-by-side evaluations of either images or captions generated by base and fine-tuned models.

---

## 1. Code File Description 

paligemma_finetuning_single.ipynb - This file contains code for finetuning PaliGemma. You have options to choose between different PaliGemma models, and customize the number of images that will be collated together. These should line up with the image grids and models that you will be using in make_droid_datasets and droid_SAE_runs.

make_droid_datasets.ipynb - This file contains code to form the different image datasets from DROID (options include collated vs single images). This notebook should be run before the next one for finetuning the SAE, droid_SAE_runs.ipynb.

droid_SAE_runs.ipynb - file for finetuning the SAE on PaliGemma, with options to choose the PaliGemma VLM model, load in the DROID dataset, and train the SAE (with potentially customizable parameters)



## üñºÔ∏è 2. Image Comparison Tool (`sae_comparison_streamlit.py`)

This tool presents two randomly selected images ‚Äî one from a base model and one from a fine-tuned model ‚Äî and asks users to vote for the better one. It randomizes the display order and logs user preferences.

### üîß Key Features

- Randomized blind comparison of images  
- Vote logging with timestamps and user identification  
- Displays total number of votes submitted  

### üõ†Ô∏è Configuration

Update the paths in the script as needed:

BASE_FOLDER = "/path/to/base/images"

FINETUNED_FOLDER = "/path/to/finetuned/images"

VOTE_LOG = "/path/to/vote_log.csv"

streamlit run sae_comparison_streamlit.py

## 3. Caption Comparison Tool (finetuning_comparison_streamlit.py)
This tool presents a single image along with two captions (from base and fine-tuned models) and asks the user to vote on which caption better describes the image. Captions are matched to the same image ID and randomized left/right.

### üîß Key Features
Side-by-side blind caption comparison

User voting with session state

Support for both .jpg and .txt file pairs

Vote log includes both captions and source labels

### üõ†Ô∏è Configuration
Update the script paths:

BASE_FOLDER = "/path/to/base/captions_and_images"

FINETUNED_FOLDER = "/path/to/finetuned/captions_and_images"

VOTE_LOG = "/path/to/vote_log.csv"

streamlit run finetuning_comparison_streamlit.py
